{{define "content"}}
<div class="manga-viewer-container py-2">

    <div class="d-flex justify-content-between align-items-end mb-4 border-bottom border-3 pb-3" style="border-color: var(--zunda-green) !important;">
        <div>
            <h1 class="fw-bold mb-1" style="color: var(--zunda-dark);">
                <i class="bi bi-collection-play-fill me-2"></i>{{.Data.Title}}
            </h1>
            <p class="text-muted mb-0 small">
                <i class="bi bi-clock-history me-1"></i>Generated by AP Manga Runner v2026
            </p>
        </div>
        <div class="btn-group shadow-sm">
            <a href="/" class="btn btn-outline-secondary border-2">
                <i class="bi bi-house-door"></i>
            </a>
            <button class="btn btn-primary fw-bold px-4">
                <i class="bi bi-download me-2"></i>Export
            </button>
        </div>
    </div>

    <ul class="nav nav-pills justify-content-center mb-5 p-2 bg-white rounded-pill shadow border" id="mangaTab" role="tablist" style="max-width: fit-content; margin: 0 auto;">
        <li class="nav-item" role="presentation">
            <button class="nav-link active rounded-pill px-5 fw-bold"
                    id="pages-tab"
                    data-bs-toggle="pill"
                    data-bs-target="#pages"
                    type="button"
                    role="tab"
                    aria-controls="pages"
                    aria-selected="true">
                <i class="bi bi-book-half me-2"></i>漫画ページ
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link rounded-pill px-5 fw-bold"
                    id="panels-tab"
                    data-bs-toggle="pill"
                    data-bs-target="#panels"
                    type="button"
                    role="tab"
                    aria-controls="panels"
                    aria-selected="false">
                <i class="bi bi-grid-3x3-gap me-2"></i>生成パネル素材
            </button>
        </li>
    </ul>

    <div class="tab-content" id="mangaTabContent">
        <div class="tab-pane fade show active" id="pages" role="tabpanel" aria-labelledby="pages-tab">
            <div class="manga-gallery d-flex flex-column align-items-center gap-5">
                {{range $index, $url := .Data.PageURLs}}
                <div class="manga-page-wrapper text-center">
                    <span class="badge rounded-pill mb-3 px-3 py-2 shadow-sm" style="background-color: var(--zunda-green);">
                        PAGE {{add $index 1}}
                    </span>
                    <div class="shadow-lg rounded overflow-hidden border border-3 border-white bg-white">
                        <img src="{{$url}}" class="img-fluid d-block mx-auto" {{if ne $index 0}}loading="lazy"{{end}}>
                    </div>
                </div>
                {{else}}
                <div class="alert alert-light border-start border-4 border-warning text-center shadow-sm w-100">
                    ページ画像がまだ錬成されていないようなのだ。
                </div>
                {{end}}
            </div>
        </div>

        <div class="tab-pane fade" id="panels" role="tabpanel" aria-labelledby="panels-tab">
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                {{range $index, $url := .Data.PanelURLs}}
                <div class="col">
                    <div class="card h-100 border-0 shadow-sm panel-card">
                        <img src="{{$url}}" class="card-img-top" loading="lazy">
                        <div class="card-body py-2 bg-light text-center">
                            <small class="text-muted fw-bold">Panel 素材 {{$index}}</small>
                        </div>
                    </div>
                </div>
                {{end}}
            </div>
        </div>
    </div>

</div>

<style>
    /* タブの視認性を劇的に改善するのだ！ */
    #mangaTab .nav-link {
        color: #495057 !important;
        background: transparent;
        border: none;
        transition: all 0.3s ease;
    }

    /* アクティブ時の色を強制的に上書きなのだ */
    #mangaTab .nav-link.active {
        background-color: var(--zunda-green) !important;
        color: white !important;
        box-shadow: 0 4px 12px rgba(118, 188, 33, 0.4) !important;
    }

    #mangaTab .nav-link:hover:not(.active) {
        background-color: #f8f9fa;
        color: var(--zunda-green) !important;
    }

    .manga-page-wrapper { width: 100%; max-width: 850px; }
    .manga-page-wrapper img { transition: transform 0.3s ease; }
    .manga-page-wrapper img:hover { transform: scale(1.01); }
</style>
{{end}}